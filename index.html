<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Multiple Vega(-Lite) Charts (Bigger + Responsive)</title>

  <!-- CDNs -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; }
    h2 { margin-top: 2rem; }
    .page { max-width: 1200px; margin: 0 auto; }
    .chart { width: 100%; min-height: 420px; margin: 1.25rem 0; }
  </style>
</head>
<body>
  <div class="page">
    <h1>Sample Vega(-Lite) Charts</h1>

    <h2>Bar Chart (Vega-Lite, Orange)</h2>
    <div id="barChart" class="chart"></div>

    <h2>Bar Chart with Pattern (Vega, Orange hatch)</h2>
    <div id="barPattern" class="chart"></div>

    <h2>Line Chart</h2>
    <div id="lineChart" class="chart"></div>

    <h2>Scatter Plot</h2>
    <div id="scatterChart" class="chart"></div>

    <h2>Rolling Average over Raw Values</h2>
    <div id="rollingChart" class="chart"></div>
  </div>

  <script>
    // Common options for embedding
    const embedOpts = { actions: { export: true, source: true, editor: true } };

    // Base for Vega-Lite specs (responsive)
    const base = {
      $schema: "https://vega.github.io/schema/vega-lite/v5.json",
      autosize: { type: "fit", contains: "padding" },
      width: "container",
      height: 400
    };

    // 1) Bar chart (Vega-Lite) — orange bars
    const barSpec = {
      ...base,
      data: { values: [
        {category:"A", value:30}, {category:"B", value:55},
        {category:"C", value:43}, {category:"D", value:91},
        {category:"E", value:70}, {category:"F", value:38}
      ]},
      mark: { type: "bar", color: "#ff7f0e", cornerRadiusTopLeft: 6, cornerRadiusTopRight: 6 },
      encoding: {
        x: { field: "category", type: "nominal", axis: { labelAngle: 0, title: "Category" }},
        y: { field: "value", type: "quantitative", axis: { title: "Value" }},
        tooltip: [{field:"category"}, {field:"value"}]
      }
    };

    // 1b) Bar chart with pattern (plain Vega) — diagonal hatch + orange
    // NOTE: Vega-Lite does not natively support pattern fills; Vega does.
    const barPatternVega = {
      $schema: "https://vega.github.io/schema/vega/v5.json",
      width: 900,
      height: 400,
      padding: 5,
      autosize: { type: "fit", contains: "padding" },
      data: [
        {
          name: "table",
          values: [
            {category:"A", value:30}, {category:"B", value:55},
            {category:"C", value:43}, {category:"D", value:91},
            {category:"E", value:70}, {category:"F", value:38}
          ]
        }
      ],
      scales: [
        { name: "x", type: "band", domain: { data: "table", field: "category" }, range: "width", padding: 0.15 },
        { name: "y", type: "linear", domain: { data: "table", field: "value" }, nice: true, range: "height" },
        { name: "color", type: "ordinal", range: ["#ff7f0e"] }
      ],
      axes: [
        { orient: "bottom", scale: "x", labelAngle: 0, title: "Category" },
        { orient: "left", scale: "y", title: "Value" }
      ],
      marks: [
        // Base orange bar
        {
          type: "rect",
          from: { data: "table" },
          encode: {
            update: {
              x: { scale: "x", field: "category" },
              width: { scale: "x", band: 1 },
              y: { scale: "y", field: "value" },
              y2: { scale: "y", value: 0 },
              fill: { value: "#ffb585" } // light orange underlay to make hatch visible
            }
          }
        },
        // Pattern overlay using canvas pattern
        {
          type: "rect",
          from: { data: "table" },
          encode: {
            update: {
              x: { scale: "x", field: "category" },
              width: { scale: "x", band: 1 },
              y: { scale: "y", field: "value" },
              y2: { scale: "y", value: 0 },
              fill: {
                signal: "pattern('diagonal-stripe', { 'stroke': '#ff7f0e', 'strokeWidth': 2, 'background': 'transparent', 'size': 8 })"
              }
            }
          }
        },
        // Optional outline to crisp edges
        {
          type: "rect",
          from: { data: "table" },
          encode: {
            update: {
              x: { scale: "x", field: "category" },
              width: { scale: "x", band: 1 },
              y: { scale: "y", field: "value" },
              y2: { scale: "y", value: 0 },
              fill: { value: "transparent" },
              stroke: { value: "#ff7f0e" },
              strokeWidth: { value: 1 }
            }
          }
        },
        // Tooltips
        {
          type: "text",
          from: { data: "table" },
          encode: {
            hover: { fillOpacity: { value: 1 } },
            update: { fillOpacity: { value: 0 } }
          }
        }
      ]
    };

    // 2) Line
    const lineSpec = {
      ...base,
      data: { values: [
        {x:0, y:2}, {x:1, y:6}, {x:2, y:3}, {x:3, y:10}, {x:4, y:7}, {x:5, y:12}
      ]},
      mark: { type: "line", point: true },
      encoding: {
        x: { field: "x", type: "quantitative", title: "X" },
        y: { field: "y", type: "quantitative", title: "Y" },
        tooltip: [{field:"x"}, {field:"y"}]
      }
    };

    // 3) Scatter
    const scatterSpec = {
      ...base,
      data: { values: [
        {x:1, y:2, category:"A"}, {x:2, y:3, category:"B"},
        {x:3, y:5, category:"C"}, {x:4, y:4, category:"D"},
        {x:5, y:7, category:"E"}, {x:6, y:6, category:"F"},
        {x:7, y:4, category:"G"}, {x:7, y:7, category:"H"}
      ]},
      mark: "point",
      encoding: {
        x: { field: "x", type: "quantitative" },
        y: { field: "y", type: "quantitative" },
        color: { field: "category", type: "nominal", legend: { title: "Group" } },
        tooltip: [{field:"x"}, {field:"y"}, {field:"category"}]
      }
    };

    // 4) Rolling average over raw values
    const rawSeries = [
      {date:"2025-09-01", value:12},{date:"2025-09-02", value:18},
      {date:"2025-09-03", value:10},{date:"2025-09-04", value:22},
      {date:"2025-09-05", value:16},{date:"2025-09-06", value:24},
      {date:"2025-09-07", value:20},{date:"2025-09-08", value:26},
      {date:"2025-09-09", value:19},{date:"2025-09-10", value:28},
      {date:"2025-09-11", value:25},{date:"2025-09-12", value:29},
      {date:"2025-09-13", value:21},{date:"2025-09-14", value:30},
      {date:"2025-09-15", value:27},{date:"2025-09-16", value:33},
      {date:"2025-09-17", value:26},{date:"2025-09-18", value:35},
      {date:"2025-09-19", value:31},{date:"2025-09-20", value:34}
    ];

    const rollingSpec = {
      ...base,
      data: { values: rawSeries },
      transform: [
        {
          window: [{ op: "mean", field: "value", as: "rolling_7d" }],
          frame: [-6, 0],
          sort: [{ field: "date", order: "ascending" }]
        }
      ],
      layer: [
        { // raw line
          mark: { type: "line", interpolate: "monotone", opacity: 0.5 },
          encoding: {
            x: { field: "date", type: "temporal", title: "Date" },
            y: { field: "value", type: "quantitative", title: "Value" },
            tooltip: [
              { field: "date", type: "temporal", title: "Date" },
              { field: "value", type: "quantitative", title: "Raw" }
            ]
          }
        },
        { // raw points
          mark: { type: "point", filled: true, opacity: 0.4, size: 40 },
          encoding: {
            x: { field: "date", type: "temporal" },
            y: { field: "value", type: "quantitative" }
          }
        },
        { // rolling avg
          mark: { type: "line", strokeWidth: 3 },
          encoding: {
            x: { field: "date", type: "temporal" },
            y: { field: "rolling_7d", type: "quantitative", title: "Value (7-day avg)" },
            tooltip: [
              { field: "date", type: "temporal", title: "Date" },
              { field: "rolling_7d", type: "quantitative", title: "7-day Avg", format: ".2f" }
            ]
          }
        }
      ],
      resolve: { scale: { y: "shared" } }
    };

    // Render all charts
    vegaEmbed("#barChart", barSpec, embedOpts);
    vegaEmbed("#barPattern", barPatternVega, embedOpts);
    vegaEmbed("#lineChart", lineSpec, embedOpts);
    vegaEmbed("#scatterChart", scatterSpec, embedOpts);
    vegaEmbed("#rollingChart", rollingSpec, embedOpts);
  </script>
</body>
</html>
